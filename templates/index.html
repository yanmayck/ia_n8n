<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Customer Service Assistant - Configuration</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div id="login-screen" class="login-container">
        <div class="login-box">
            <h2>Acesso Restrito</h2>
            <form id="login-form">
                <label for="password">Senha de Acesso:</label>
                <input type="password" id="password" name="password" required>
                <button type="submit">Entrar</button>
                <p id="login-error" class="login-error-message" style="display: none;">Senha incorreta.</p>
            </form>
        </div>
    </div>

    <div id="main-content" class="container" style="display: none;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h1>AI Customer Service Assistant - Configuration</h1>
            <button id="logout-button" style="background: #dc3545; padding: 8px 15px; font-size: 0.9rem;">Sair</button>
        </div>
        <div class="main-container">
            <div class="left-column">
                <div class="form-section">
                    <h2>Clientes Cadastrados</h2>
                    <ul id="client-list"></ul>
                </div>
            </div>
            <div class="right-column">
                <div class="form-section">
                    <h2>Gerenciamento de Clientes</h2>
                    <p>Crie um novo cliente (tenant) para usar o assistente de atendimento.</p>
                    <form id="create-tenant-form">
                        <label for="tenant_id_create">Nome da Instância</label>
                        <input type="text" id="tenant_id_create" name="tenant_id" required>
                        
                        <label for="nome_loja_create">Nome da Loja</label>
                        <input type="text" id="nome_loja_create" name="nome_loja" required>
                        
                        <label for="ia_personality_create">Nome da Personalidade da IA</label>
                        <input type="text" id="ia_personality_create" name="ia_personality" required>
                        
                        <label for="ai_prompt_description_create">Descrição do Prompt da IA</label>
                        <textarea id="ai_prompt_description_create" name="ai_prompt_description" rows="5" required></textarea>
                        
                        <label for="endereco_create">Endereço da Loja</label>
                        <input type="text" id="endereco_create" name="endereco" required>
                        
                        <label for="cep_create">CEP</label>
                        <input type="text" id="cep_create" name="cep" required>
                        
                        <label for="latitude_create">Latitude</label>
                        <input type="number" id="latitude_create" name="latitude" step="any" required>
                        
                        <label for="longitude_create">Longitude</label>
                        <input type="number" id="longitude_create" name="longitude" step="any" required>
                        
                        <label for="loja_txt_create">Arquivo com informações da empresa</label>
                        <div id="loja_txt_edit_area">
                            <textarea id="loja_txt_content" name="loja_txt_content" rows="10" style="width: 100%; display: none;"></textarea>
                            <input type="file" id="loja_txt_upload" name="loja_txt_upload" accept=".txt" style="display: block;">
                            <button type="button" id="download_loja_txt" style="display: none; margin-top: 5px; background: #3498db;">Baixar TXT Atual</button>
                        </div>
                        
                        <label for="produtos_excel_create">Tabela de produtos (.xlsx)</label>
                        <input type="file" id="produtos_excel_create" name="produtos_excel" accept=".xlsx,.xls" required>
                        <button type="button" id="download_produtos_excel" style="display: none; margin-top: 5px; background: #27ae60;">Baixar Excel Atual</button>
                        
                        <label for="menu_image_create">Imagem do Cardápio (opcional)</label>
                        <input type="file" id="menu_image_create" name="menu_image" accept="image/*">
                        
                        <div id="current_menu_image_preview" style="margin-top: 10px; margin-bottom: 10px;">
                            <!-- A imagem do cardápio atual será carregada aqui para edição -->
                        </div>

                        <label for="freight_config_create">Configuração de Frete (JSON)</label>
                        <input type="text" id="freight_config_create" name="freight_config" placeholder='Ex: {"type": "FIXED", "price": 10.0}'>
                        <div style="margin-top: 10px; padding: 10px; background-color: #3a3a5a; border-radius: 5px; font-size: 0.9em; line-height: 1.4;">
                            <p style="margin: 0 0 5px 0;"><strong>Formatos Suportados:</strong></p>
                            <p style="margin: 2px 0;"><strong>Fixo:</strong> <code>{"type": "FIXED", "price": 10.00}</code></p>
                            <p style="margin: 2px 0;"><strong>Por KM:</strong> <code>{"type": "PER_KM", "price_per_km": 2.50}</code></p>
                            <p style="margin: 2px 0;"><strong>Por Faixa:</strong> <code>{"type": "TIERED", "tiers": [{"up_to_km": 3, "price": 5.00}, {"up_to_km": 999, "price": 10.00}]}</code></p>
                        </div>
                        
                        <button type="submit">Salvar Cliente</button>
                        <button type="button" id="cancel-edit" style="display: none; background: #e74c3c;">Cancelar Edição</button>
                    </form>
                </div>

                <div class="form-section">
                    <h2>Calcular Frete</h2>
                    <form id="calcular-frete-form">
                        <label for="frete_tenant_id">Cliente/Loja</label>
                        <select id="frete_tenant_id" name="tenant_id" required>
                            <option value="">Selecione uma loja...</option>
                        </select>
                        
                        <label for="cliente_lat">Latitude do Cliente</label>
                        <input type="number" id="cliente_lat" name="cliente_lat" step="any" required>
                        
                        <label for="cliente_lng">Longitude do Cliente</label>
                        <input type="number" id="cliente_lng" name="cliente_lng" step="any" required>
                        
                        <button type="submit">Calcular Frete</button>
                    </form>
                    <div id="frete-result" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px; display: none;"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>
